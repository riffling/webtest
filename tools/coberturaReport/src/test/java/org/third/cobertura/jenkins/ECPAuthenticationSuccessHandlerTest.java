package org.third.cobertura.jenkins;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
public class ECPAuthenticationSuccessHandlerTest {

	@Test
	public void canReturnAuthenticationOnSuccess() throws Throwable {
//		ECPAuthenticationSuccessHandler handler = new ECPAuthenticationSuccessHandler();
//
//		String principal = "consumer";
//		String credentials = "cloud";
//		UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(principal, credentials);
//		HttpServletRequest request = new MockHttpServletRequest(null, "GET", "testURL");
//		HttpServletResponse response = new MockHttpServletResponse();
//		handler.onAuthenticationSuccess(request, response, token);
	}

//	@Rule
//	public ExpectedException exception = ExpectedException.none();

//	@PrepareForTest({ EcpUtils.class })
	@Test
	public void canThrowOnException() throws Throwable {
//		ECPAuthenticationSuccessHandler handler = new ECPAuthenticationSuccessHandler();
//
//		String principal = "consumer";
//		String credentials = "cloud";
//		UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(principal, credentials);
//		HttpServletRequest request = new MockHttpServletRequest(null, "GET", "testURL");
//		HttpServletResponse response = new MockHttpServletResponse();
//		PowerMockito.mockStatic(EcpUtils.class);
//		PowerMockito.when(EcpUtils.toBytes(token)).thenThrow(new Exception("testException"));
//		this.exception.expect(IOException.class);
//		this.exception.expectMessage("ECP authentication cannot be serialized");
//		handler.onAuthenticationSuccess(request, response, token);

	}
}
